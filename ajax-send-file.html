<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajax Send File</title>
</head>

<body>
    <form>
        <pre>
            <label for="username">Username : <input type="username" id="username"></label>
            <br>
            <label for="name">Name : <input type="text" id="name" name="name"></label>
            <br>
            <label for="profile">Profile : <input type="file" id="profile" name="profile"></label>
            <button id="register">Register</button>
         </pre>
    </form>
    <h1 id="response"></h1>
    <script>
        // function doRegister() {
        //     const ajax = new XMLHttpRequest();
        //     ajax.open("POST", "https://pie.dev/post");
        //     ajax.onload = function () {
        //         const response = document.getElementById("response");
        //         response.innerText = ajax.responseText;
        //     }
        //     const form = new FormData();
        //     form.append("username", document.getElementById("username").value);
        //     form.append("name", document.getElementById("name").value);

        //     const files = document.getElementById("profile").files;
        //     const firstFile = files.item[0];
        //     console.log(files);
        //     console.log(firstFile);

        //     form.append("profile", firstFile);
        //     ajax.send(form);
        // }
        // document.getElementById("register").onclick = doRegister();

        const register = document.getElementById("register");
        register.addEventListener("click", (e) => {
            e.preventDefault();
            const ajax = new XMLHttpRequest();
            ajax.open("POST", "https://pie.dev/post");
            ajax.onload = function () {
                const response = document.getElementById("response");
                response.innerText = ajax.responseText;
            }
            const form = new FormData();
            form.append("username", document.getElementById("username").value);
            form.append("name", document.getElementById("name").value);

            const files = document.getElementById("profile").files;
            const firstFile = files.item(0);
            console.log(files);
            console.log(firstFile);

            form.append("profile", firstFile);
            ajax.send(form);
        });
    </script>
</body>

</html>